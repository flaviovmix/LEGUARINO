<html>
<!--
 Copyright (C) 2022 XStream committers.
 All rights reserved.
 
 The software in this package is published under the terms of the BSD
 style license a copy of which has been included with this distribution in
 the LICENSE.txt file.
 
 Created on 26. November 2022 by Joerg Schaible
 -->
  <head>
    <title>CVE-2022-40151</title>
  </head>
  <body>

    <h2 id="vulnerability">Vulnerability</h2>
    
    <p>CVE-2022-40151: XStream is vulnerable to a Denial of Service attack due to stack overflow.</p>
    
    <h2 id="affected_versions">Affected Versions</h2>
    
    <p>All versions until and including version 1.4.19 are affected, if using the version out of the box.</p>

    <h2 id="description">Description</h2>
    
    <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.
    XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed
    input stream and replace or inject objects, that result in a stack overflow due to deeply nested objects causing a
    denial of service.</p>

    <h2 id="reproduction">Steps to Reproduce</h2>

    <p>Create a simple HashSet and use XStream to marshal it to XML.  Replace the XML with generated with the
    following code snippet and unmarshal it with XStream:</p>
<div class="Source Java"><pre>String xml = new String();
        int i = 0;
        for( ; i &lt; 10000; ++i) {
            xml += "&lt;set&gt;";
        }
        for( ; i &gt; 0; --i) {
            xml += "&lt;/set&gt;";
        }
</pre></div>
<div class="Source Java"><pre>XStream xstream = new XStream();
xstream.fromXML(xml);
</pre></div>

    <p>As soon as the XML gets unmarshalled, the recursion is too deep and the executing thread is aborted with a stack
    overflow error.</p>

    <h2 id="impact">Impact</h2>

    <p>The vulnerability may allow a remote attacker to terminate the application with a stack overflow error resulting
    in a denial of service only by manipulating the processed input stream.</p>

    <h2 id="workarounds">Workarounds</h2>

	<p>The only solution is to catch the StackOverflowError in the client code calling XStream.</p>

    <h2 id="credits">Credits</h2>
    
    <p>Henry Lin of the Google OSS-Fuzz team found and reported the issue to XStream and provided the required
    information to reproduce it.</p>
    
      </body>
 </html>
